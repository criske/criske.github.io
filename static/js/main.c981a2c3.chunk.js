(this["webpackJsonpmy-git-feed-client"]=this["webpackJsonpmy-git-feed-client"]||[]).push([[0],{23:function(e,t,n){},25:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(17),s=n.n(a),o=(n(23),n(5)),i=n(2),l={LOADING:Symbol("loading"),FETCH:Symbol("fetch"),USER:Symbol("user"),SELECTED:Symbol("selected"),ASSIGNMENTS:Symbol("assignments"),COMMITS:Symbol("commits"),REPOS:Symbol("repos"),API_READY:Symbol("api_ready")},u={fetch:{loading:!1,call:{name:null,args:[],onSuccess:{name:null,args:[]}}},ready:!1,provider:{name:"Github",user:{name:"",avatar:null,link:"",provider:"Github"}},pages:{selected:"home",home:{},assignments:{},commits:{},repos:{}}},j=n(0),d=Object(c.createContext)(u),b=function(e){var t=e.children,n=Object(c.useReducer)((function(e,t){switch(t.type){case l.API_READY:return Object(i.a)(Object(i.a)({},e),{},{ready:!0});case l.LOADING:return Object(i.a)(Object(i.a)({},e),{},{fetch:Object(i.a)(Object(i.a)({},e.fetch),{},{loading:t.payload})});case l.FETCH:return Object(i.a)(Object(i.a)({},e),{},{fetch:Object(i.a)(Object(i.a)({},e.fetch),{},{call:t.payload})});case l.USER:return Object(i.a)(Object(i.a)({},e),{},{provider:{name:t.payload.provider,user:t.payload}});case l.SELECTED:return Object(i.a)(Object(i.a)({},e),{},{page:Object(i.a)(Object(i.a)({},e.page),{},{name:t.payload})});case l.ASSIGNMENTS:var n=Object(i.a)({},e);return n.pages.selected="assignments",n.pages.assignments=t.payload,n;case l.COMMITS:var c=Object(i.a)({},e);return c.pages.selected="commits",c.pages.commits=t.payload,c;case l.REPOS:var r=Object(i.a)({},e);return r.pages.selected="repos",r.pages.repos=t.payload,r;default:return e}}),u),r=Object(o.a)(n,2),a=r[0],s=r[1],b={loading:function(e){s({type:l.LOADING,payload:e})},fetch:function(e,t,n,c){s({type:l.FETCH,payload:{name:"".concat(e,"#").concat(1e7*Math.random()),args:t||[],onSuccess:{name:n||null,args:c||[]}}})},user:function(e){s({type:l.USER,payload:e})},content:function(e,t){return s({type:l.PAGE_CONTENT,payload:{page:e,content:t}})},select:function(e){return s({type:l.SELECTED,payload:{page:e}})},assignments:function(e){return s({type:l.ASSIGNMENTS,payload:{page:e}})},commits:function(e){return s({type:l.COMMITS,payload:{page:e}})},repos:function(e){return s({type:l.REPOS,payload:{page:e}})},ready:function(){return s({type:l.API_READY})}};return Object(j.jsx)(d.Provider,{value:{state:a,actions:b},children:t})},O=n(9);n(25);function p(e){var t=e.hasRounter,n=e.provider,r=e.onSelect,a=t?O.a:c.Fragment;return Object(j.jsx)(a,{children:Object(j.jsxs)("nav",{children:[Object(j.jsxs)("div",{className:"user",children:[n.user.avatar?Object(j.jsx)("img",{src:n.user.avatar}):Object(j.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:Object(j.jsx)("path",{strokeLinecap:"round",stroke:"white",strokeLinejoin:"round",strokeWidth:"1",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),Object(j.jsx)("div",{className:"provider",children:n.name}),Object(j.jsx)("a",{href:n.user.link,children:n.user.name})]}),Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:Object(j.jsx)(O.b,{to:"/",children:"Home"})}),Object(j.jsx)("li",{children:Object(j.jsx)(O.b,{to:"/assignments",children:"Assignments"})}),Object(j.jsx)("li",{children:Object(j.jsx)(O.b,{to:"/repos",children:"Repos"})}),Object(j.jsx)("li",{children:Object(j.jsx)(O.b,{to:"/commits",children:"Commits"})})]}),Object(j.jsx)("div",{className:"providers",children:Object(j.jsxs)("select",{value:n.name,onChange:function(e){r(e.target.value)},children:[Object(j.jsx)("option",{value:"Github",children:"Github"}),Object(j.jsx)("option",{value:"Gitlab",children:"Gitlab"}),Object(j.jsx)("option",{value:"Bitbucket",children:"Bitbucket"})]})})]})})}function h(e){var t=e.hasRounter,n=Object(c.useContext)(d),r=n.state,a=n.actions,s=Object(c.useState)(r.provider.name),i=Object(o.a)(s,2),l=i[0],u=i[1];return Object(c.useEffect)((function(){a.fetch("user",[l],"user")}),[l]),Object(j.jsx)(p,{provider:r.provider,onSelect:u,hasRounter:t})}p.defaultProps={hasRounter:!1,provider:{name:"",user:{name:"",avatar:null,link:""}},onSelect:function(e){}},h.defaultProps={hasRounter:!1};var m=n(3);var f=[{path:"/",component:function(){Object(c.useContext)(d).state;return Object(j.jsx)("div",{children:"Home"})}},{path:"/commits",component:function(e){var t=e.location,n=Object(c.useContext)(d),r=n.state,a=n.actions;return Object(c.useEffect)((function(){a.fetch("commits",[r.provider.name],"commits")}),[t.key,r.provider.name]),Object(j.jsxs)("div",{children:[Object(j.jsx)("h4",{children:"Commits"}),Object(j.jsx)("p",{children:JSON.stringify(r.pages.commits)})]})}},{path:"/repos",component:function(e){var t=e.location,n=Object(c.useContext)(d),r=n.state,a=n.actions;return Object(c.useEffect)((function(){a.fetch("repos",[r.provider.name],"repos")}),[t.key,r.provider.name]),Object(j.jsxs)("div",{children:[Object(j.jsx)("h4",{children:"Owned Repositories"}),Object(j.jsx)("p",{children:JSON.stringify(r.pages.repos)})]})}},{path:"/assignments",component:function(e){var t=e.location,n=Object(c.useContext)(d),r=n.state,a=n.actions;return Object(c.useEffect)((function(){a.fetch("assignments",[r.provider.name],"assignments")}),[t.key,r.provider.name]),Object(j.jsxs)("div",{children:[Object(j.jsx)("h4",{children:"Assignments"}),Object(j.jsx)("p",{children:JSON.stringify(r.pages.assignments)})]})}}];function x(){return Object(j.jsx)(m.c,{children:f.map((function(e,t){return Object(j.jsx)(m.a,{exact:!0,path:e.path,render:function(t){return Object(j.jsx)(e.component,Object(i.a)(Object(i.a)({},t),{},{routes:e.routes}))}},t)}))})}n(31);var v=function(e){var t=new AbortController,n=t.signal;return{request:fetch("".concat("https://my-git-feed.herokuapp.com").concat(e),{signal:n,headers:{"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject({message:e.error})}))})).catch((function(e){return Promise.reject(e.message)})),cancel:function(){try{t.abort()}catch(e){console.error(e)}}}},g={ping:function(){return v("/check/ping")},user:function(e){return v("/api/".concat(e,"/me"))},assignments:function(e){return v("/api/".concat(e,"/assignments"))},commits:function(e){return v("/api/".concat(e,"/commits"))},repos:function(e){return v("/api/".concat(e,"/repos"))}};function y(e){var t=e.children,n=Object(c.useContext)(d),a=n.state,s=n.actions,i=Object(c.useState)(0),l=Object(o.a)(i,2),u=l[0],j=l[1],b=Object(c.useState)((function(){})),O=Object(o.a)(b,2),p=O[0],h=O[1],m=Object(c.useState)(null),f=Object(o.a)(m,2),x=f[0],v=f[1],y=function(){j(u+1)},S=function(){p(),s.loading(!1),v("Canceled")},C=a.fetch.call.name;return Object(c.useEffect)((function(){if(null!=C){var e=a.fetch.call.name.split("#")[0];null===p||void 0===p||p.call(null),s.loading(!0),v(null);var t=g[e].call(null,a.fetch.call.args);t.request.then((function(e){v(null);var t=a.fetch.call.onSuccess.name;s[t].call(null,e)})).catch(v).finally((function(){return s.loading(!1)})),h((function(){return t.cancel}))}}),[u,C]),r.a.Children.map(t,(function(e){return r.a.cloneElement(e,{isLoading:a.fetch.loading,error:x,onRetry:y,onCancel:S})}))}n(32);var S=function(e){var t=e.error,n=e.onRetry,c=e.onClose;return Object(j.jsxs)("div",{className:"error-box",children:[Object(j.jsx)("svg",{onClick:c,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:Object(j.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),Object(j.jsx)("p",{children:t}),Object(j.jsx)("a",{onClick:n,children:"Retry"})]})},C=function(){return Object(j.jsx)("div",{className:"loading-spinner"})};function E(e){var t=e.isLoading,n=e.error,r=e.onRetry,a=Object(c.useState)(!t&&null!==n),s=Object(o.a)(a,2),i=(s[0],s[1],Object(c.useState)(!1)),l=Object(o.a)(i,2),u=l[0],d=l[1];return Object(c.useEffect)((function(){d(!t&&null!=n)}),[t,n]),Object(j.jsxs)("div",{className:"fetch-container",children:[t&&Object(j.jsx)(C,{}),u&&Object(j.jsx)(S,{error:n,onRetry:r,onClose:function(){return d(!1)}})]})}function k(){return Object(j.jsx)(O.a,{children:Object(j.jsxs)("div",{className:"container",children:[Object(j.jsx)(h,{}),Object(j.jsx)("div",{className:"nav-content",children:Object(j.jsx)(x,{})}),Object(j.jsx)(y,{children:Object(j.jsx)(E,{})})]})})}n(33);function R(e){var t=e.isLoading,n=e.error,c=e.onRetry,r=e.onCancel;return Object(j.jsx)("div",{className:"splash-container",children:t?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("h1",{children:"Waking up the server"}),Object(j.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})}),Object(j.jsx)("button",{onClick:r,children:"Cancel"})]}):Object(j.jsxs)("div",{children:[n," ",Object(j.jsx)("button",{onClick:c,children:"Retry"})," "]})})}function N(e){var t=Object(c.useContext)(d).actions;return Object(c.useEffect)((function(){t.fetch("ping",[],"ready")}),[]),Object(j.jsx)(R,Object(i.a)({},e))}function w(){var e=Object(c.useContext)(d).state;return Object(j.jsx)(j.Fragment,{children:e.ready?Object(j.jsx)(k,{}):Object(j.jsx)(y,{children:Object(j.jsx)(N,{})})})}R.defaultProps={onCancel:function(){},onRetry:function(){},error:null,isLoading:!1};var L=function(){return Object(j.jsx)(b,{children:Object(j.jsx)(w,{})})};s.a.render(Object(j.jsx)(L,{}),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.c981a2c3.chunk.js.map