(this["webpackJsonpmy-git-feed-client"]=this["webpackJsonpmy-git-feed-client"]||[]).push([[0],{17:function(e,t,n){},24:function(e,t,n){},26:function(e,t,n){},27:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var c,r,a=n(18),s=n.n(a),i=(n(24),n(5)),o=n(2),j=n(1);!function(e){e.LOADING="loading",e.FETCH="fetch",e.USER="user",e.SELECTED="selected",e.ASSIGNMENTS="assignments",e.COMMITS="commits",e.REPOS="repos",e.READY="ready",e.NONE=""}(c||(c={})),function(e){e[e.home=0]="home",e[e.assignments=1]="assignments",e[e.commits=2]="commits",e[e.repos=3]="repos"}(r||(r={}));var u={fetch:{loading:!1,call:{name:null,args:[],stateActionType:c.NONE}},ready:!1,provider:{name:"Github",user:{name:"",avatar:null,link:"",provider:"Github"}},pages:{selected:r.home,home:{},assignments:{},commits:{},repos:{}}},l=n(0),d=Object(j.createContext)({state:u,actions:{loading:function(){},fetch:function(){},select:function(){},dispatch:function(){}}}),b=function(e){var t=e.children,n=Object(j.useReducer)((function(e,t){switch(t.type){case c.READY:return Object(o.a)(Object(o.a)({},e),{},{ready:!0});case c.LOADING:return Object(o.a)(Object(o.a)({},e),{},{fetch:Object(o.a)(Object(o.a)({},e.fetch),{},{loading:t.payload})});case c.FETCH:return Object(o.a)(Object(o.a)({},e),{},{fetch:Object(o.a)(Object(o.a)({},e.fetch),{},{call:t.payload})});case c.USER:var n;return Object(o.a)(Object(o.a)({},e),{},{provider:{name:null===(n=t.payload)||void 0===n?void 0:n.provider,user:t.payload}});case c.SELECTED:return Object(o.a)(Object(o.a)({},e),{},{pages:Object(o.a)(Object(o.a)({},e.pages),{},{selected:t.payload})});case c.ASSIGNMENTS:return Object(o.a)(Object(o.a)({},e),{},{pages:Object(o.a)(Object(o.a)({},e.pages),{},{assignments:t.payload})});case c.COMMITS:return Object(o.a)(Object(o.a)({},e),{},{pages:Object(o.a)(Object(o.a)({},e.pages),{},{commits:t.payload})});case c.REPOS:return Object(o.a)(Object(o.a)({},e),{},{pages:Object(o.a)(Object(o.a)({},e.pages),{},{repos:t.payload})});default:return e}}),u),r=Object(i.a)(n,2),a=r[0],s=r[1],b={loading:function(e){s({type:c.LOADING,payload:e})},select:function(e){return s({type:c.SELECTED,payload:e})},fetch:function(e,t,n){s({type:c.FETCH,payload:{name:"".concat(e,"#").concat(1e7*Math.random()),args:n||[],stateActionType:t}})},dispatch:function(e,t){s({type:e,payload:t})}};return Object(l.jsxs)(d.Provider,{value:{state:a,actions:b},children:[" ",t," "]})},O=n(9),h=(n(26),function(e){var t=e.error,n=e.onRetry,c=e.onClose;return Object(l.jsxs)("div",{className:"error-box",children:[Object(l.jsx)("svg",{onClick:c,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:Object(l.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),Object(l.jsx)("p",{children:t}),Object(l.jsx)("a",{onClick:n,children:"Retry"})]})}),p=function(){return Object(l.jsx)("div",{className:"loading-spinner"})};function m(e){var t=e.isLoading,n=e.error,c=e.onRetry,r=Object(j.useState)(!t&&null!==n),a=Object(i.a)(r,2),s=(a[0],a[1],Object(j.useState)(!1)),o=Object(i.a)(s,2),u=o[0],d=o[1];return Object(j.useEffect)((function(){d(!t&&null!=n)}),[t,n]),Object(l.jsxs)("div",{className:"fetch-container",children:[t&&Object(l.jsx)(p,{}),u&&Object(l.jsx)(h,{error:n,onRetry:c,onClose:function(){return d(!1)}})]})}var f=function(e){var t=new AbortController,n=t.signal;return{request:fetch("".concat("https://my-git-feed.herokuapp.com").concat(e),{signal:n,headers:{"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject({message:e.error})}))})).catch((function(e){return Promise.reject(e.message)})),cancel:function(){try{t.abort()}catch(e){console.error(e)}}}},v={ping:function(){return f("/check/ping")},user:function(e){return f("/api/".concat(e,"/me"))},assignments:function(e){return f("/api/".concat(e,"/assignments"))},commits:function(e){return f("/api/".concat(e,"/commits"))},repos:function(e){return f("/api/".concat(e,"/repos"))}},x=Object(j.createContext)({isLoading:!1,error:null,onRetry:function(){},onCancel:function(){}}),g=function(e){var t=e.children,n=Object(j.useContext)(d),c=n.state,r=n.actions,a=Object(j.useState)(0),s=Object(i.a)(a,2),o=s[0],u=s[1],b=Object(j.useState)((function(){})),O=Object(i.a)(b,2),h=O[0],p=O[1],m=Object(j.useState)(null),f=Object(i.a)(m,2),g=f[0],y=f[1],C=c.fetch.call.name;Object(j.useEffect)((function(){if(null!=C){var e=C.split("#")[0];null===h||void 0===h||h.call(null),r.loading(!0),y(null);var t=v[e].call(null,c.fetch.call.args);t.request.then((function(e){var t=c.fetch.call.stateActionType;r.dispatch(t,e)})).catch(y).finally((function(){return r.loading(!1)})),p((function(){return t.cancel}))}}),[o,C]);var E={isLoading:c.fetch.loading,error:g,onRetry:function(){u(o+1)},onCancel:function(){h(),r.loading(!1),y("Canceled")}};return Object(l.jsxs)(x.Provider,{value:E,children:[" ",t," "]})};function y(){var e=Object(j.useContext)(x);return Object(l.jsx)(m,Object(o.a)({},e))}n(27);function C(e){var t=e.hasRounter,n=e.provider,c=e.onSelect,r=t?O.a:j.Fragment;return Object(l.jsx)(r,{children:Object(l.jsxs)("nav",{children:[Object(l.jsxs)("div",{className:"user",children:[n.user.avatar?Object(l.jsx)("img",{src:n.user.avatar}):Object(l.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:Object(l.jsx)("path",{strokeLinecap:"round",stroke:"white",strokeLinejoin:"round",strokeWidth:"1",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),Object(l.jsx)("div",{className:"provider",children:n.name}),Object(l.jsx)("a",{href:n.user.link,children:n.user.name})]}),Object(l.jsxs)("ul",{children:[Object(l.jsx)("li",{children:Object(l.jsx)(O.b,{to:"/",children:"Home"})}),Object(l.jsx)("li",{children:Object(l.jsx)(O.b,{to:"/assignments",children:"Assignments"})}),Object(l.jsx)("li",{children:Object(l.jsx)(O.b,{to:"/repos",children:"Repos"})}),Object(l.jsx)("li",{children:Object(l.jsx)(O.b,{to:"/commits",children:"Commits"})})]}),Object(l.jsx)("div",{className:"providers",children:Object(l.jsxs)("select",{value:n.name,onChange:function(e){c(e.target.value)},children:[Object(l.jsx)("option",{value:"Github",children:"Github"}),Object(l.jsx)("option",{value:"Gitlab",children:"Gitlab"}),Object(l.jsx)("option",{value:"Bitbucket",children:"Bitbucket"})]})})]})})}function E(){var e=Object(j.useContext)(d),t=e.state,n=e.actions,r=Object(j.useState)(t.provider.name),a=Object(i.a)(r,2),s=a[0],o=a[1];return Object(j.useEffect)((function(){n.fetch("user",c.USER,[s])}),[s]),Object(l.jsx)(C,{provider:t.provider,onSelect:o,hasRounter:!1})}E.defaultProps={hasRounter:!1};var N=n(3);function S(e){return Object(l.jsx)("div",{className:"card assignment",children:e.title})}function k(e){var t=e.assignments;return Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{children:"Assignments"}),Object(l.jsx)("div",{className:"grid-container",children:t.map((function(e,t){return Object(l.jsx)(S,Object(o.a)({},e),t)}))})]})}function R(e){return new Date(e).toLocaleString()}function w(e){return Object(l.jsxs)("div",{className:"card",children:[Object(l.jsxs)("div",{children:[Object(l.jsx)("div",{children:e.repo.name}),Object(l.jsxs)("div",{children:[" ",e.sha," "]}),Object(l.jsxs)("div",{children:[" ",R(e.date)]})]}),Object(l.jsx)("div",{children:e.message||"No message"})]})}function A(e){var t=e.commits;return Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{children:"Commits"}),Object(l.jsx)("div",{className:"grid-container",children:t.map((function(e,t){return Object(l.jsx)(w,Object(o.a)({},e),e.sha)}))})]})}var L=function(){return Object(l.jsx)("div",{children:"Home"})};function M(){return Object(l.jsx)("h2",{children:"Not found"})}n(17);function T(e){var t=Object(j.useMemo)((function(){return R(e.createdAt)}),[e.createdAt]),n=Object(j.useMemo)((function(){return R(e.updatedAt)}),[e.updatedAt]);return Object(l.jsxs)("div",{className:"card repo",children:[Object(l.jsxs)("div",{children:[Object(l.jsx)("a",{href:e.url,children:e.name}),Object(l.jsx)("div",{children:e.language}),Object(l.jsx)("div",{children:e.stars})]}),Object(l.jsx)("div",{children:e.description||"No description"}),Object(l.jsxs)("div",{children:[Object(l.jsxs)("div",{children:["Created: ",t]}),Object(l.jsxs)("div",{children:["Updated: ",n]})]})]})}function G(e){var t=e.repos;return Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{children:"Owned repositories"}),Object(l.jsx)("div",{className:"grid-container",children:t.map((function(e){return Object(l.jsx)(T,Object(o.a)({},e),e.name)}))})]})}var z=[{path:"/",component:L},{path:"/commits",component:function(e){var t=e.location,n=Object(j.useContext)(d),r=n.state,a=n.actions;Object(j.useEffect)((function(){a.fetch("commits",c.COMMITS,[r.provider.name])}),[t.key,r.provider.name]);var s=(r.pages.commits.entries||[]).map((function(e){return{date:e.date,sha:e.sha,url:e.url,message:e.message,repo:{name:e.repo.fullName,url:e.repo.url}}}));return Object(l.jsx)(A,{commits:s})}},{path:"/repos",component:function(e){var t=e.location,n=Object(j.useContext)(d),r=n.state,a=n.actions;Object(j.useEffect)((function(){a.fetch("repos",c.REPOS,[r.provider.name])}),[t.key,r.provider.name]);var s=(r.pages.repos.entries||[]).map((function(e){return{name:e.simple.name,url:e.simple.url,language:e.language,description:null===e.description?void 0:e.description,organization:null===e.organization?void 0:e.organization,createdAt:e.createdAt,updatedAt:e.updatedAt,stars:e.stars}}));return Object(l.jsx)(G,{repos:s})}},{path:"/assignments",component:function(e){var t=e.location,n=Object(j.useContext)(d),r=n.state,a=n.actions;Object(j.useEffect)((function(){a.fetch("assignments",c.ASSIGNMENTS,[r.provider.name])}),[t.key,r.provider.name]);var s=(r.pages.assignments.entries||[]).map((function(e){return{title:e.title,body:e.body,repo:{name:e.repo.fullName,url:e.repo.url},author:{name:e.author.name,avatar:e.author.avatar,url:e.author.url}}}));return Object(l.jsx)(k,{assignments:s})}}];function D(){return Object(l.jsxs)(N.c,{children:[z.map((function(e,t){return Object(l.jsx)(N.a,{exact:!0,path:e.path,render:function(t){return Object(l.jsx)(e.component,Object(o.a)(Object(o.a)({},t),{},{routes:e.routes}))}},t)})),Object(l.jsx)(N.a,{component:M})]})}n(33);function I(){return Object(l.jsx)(O.a,{children:Object(l.jsxs)("div",{className:"container",children:[Object(l.jsx)(E,{}),Object(l.jsx)("div",{className:"nav-content",children:Object(l.jsx)(D,{})}),Object(l.jsx)(y,{})]})})}n(34);function P(e){var t=e.isLoading,n=e.error,c=e.onRetry,r=e.onCancel;return Object(l.jsx)("div",{className:"splash-container",children:t?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("h1",{children:"Waking up the server"}),Object(l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})}),Object(l.jsx)("button",{onClick:r,children:"Cancel"})]}):Object(l.jsxs)("div",{children:[n," ",Object(l.jsx)("button",{onClick:c,children:"Retry"})," "]})})}function B(){var e=Object(j.useContext)(d).actions,t=Object(j.useContext)(x);return Object(j.useEffect)((function(){e.fetch("ping",c.READY)}),[]),Object(l.jsx)(P,Object(o.a)({},t))}function F(){var e=Object(j.useContext)(d).state;return Object(l.jsx)(l.Fragment,{children:e.ready?Object(l.jsx)(I,{}):Object(l.jsx)(B,{})})}P.defaultProps={onCancel:function(){},onRetry:function(){},error:null,isLoading:!1};var H=function(){return Object(l.jsx)(b,{children:Object(l.jsx)(g,{children:Object(l.jsx)(F,{})})})};s.a.render(Object(l.jsx)(H,{}),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.1b821b27.chunk.js.map